---
description: Apprenez à gérer les dossiers de données utilisateur dans les applications WebView2
title: Gestion du dossier des données utilisateur dans les applications WebView2.
author: MSEdgeTeam
ms.author: msedgedevrel
ms.date: 06/02/2020
ms.topic: conceptual
ms.prod: microsoft-edge
ms.technology: webview
keywords: IWebView2, IWebView2WebView, webview2, WebView, applications Win32, Win32, Edge, ICoreWebView2, ICoreWebView2Host, contrôle de navigateur, html Edge, dossier de données utilisateur
ms.openlocfilehash: a7a6fd620cfb417e349a03159204ceb68998745e
ms.sourcegitcommit: e49b86082da884299fdd485d3311d63a7688c0d0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/22/2020
ms.locfileid: "10755398"
---
# <span data-ttu-id="6e3a2-104">Gestion du dossier de données utilisateur</span><span class="sxs-lookup"><span data-stu-id="6e3a2-104">Managing the User Data Folder</span></span>

<span data-ttu-id="6e3a2-105">Les applications WebView2 interagissent avec les dossiers de données utilisateur pour stocker les données du navigateur, telles que les cookies, les autorisations et les ressources mises en cache.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-105">WebView2 applications interact with user data folders to store browser data, such as cookies, permissions, and cached resources.</span></span> <span data-ttu-id="6e3a2-106">Chaque instance d’un contrôle WebView2 est associée à un dossier de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-106">Each instance of a WebView2 control is associated with a user data folder.</span></span> <span data-ttu-id="6e3a2-107">Chaque dossier de données utilisateur est propre à un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-107">Each user data folder is unique to a user.</span></span>

## <span data-ttu-id="6e3a2-108">Meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="6e3a2-108">Best Practices</span></span>

<span data-ttu-id="6e3a2-109">Les dossiers de données utilisateurs sont créés automatiquement par WebView2.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-109">User data folders are created automatically by WebView2.</span></span> <span data-ttu-id="6e3a2-110">Les développeurs WebView2 contrôlent la durée de vie du dossier des données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-110">WebView2 developers control the lifetime of the user data folder.</span></span> <span data-ttu-id="6e3a2-111">Si votre application réutilise les données utilisateur des sessions d’application, envisagez d’enregistrer les dossiers de données des utilisateurs, sinon vous pouvez les supprimer.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-111">If your application re-uses user data from application sessions, consider saving the user data folders, otherwise you may delete them.</span></span> <span data-ttu-id="6e3a2-112">Prenez en compte les scénarios suivants lorsque vous décidez comment gérer vos dossiers de données utilisateur:</span><span class="sxs-lookup"><span data-stu-id="6e3a2-112">Consider the following scenarios when deciding how to manage your user data folders:</span></span>

*   <span data-ttu-id="6e3a2-113">Si le même utilisateur utilise votre application de manière répétée et que le contenu Web de l’application repose sur les données de l’utilisateur, enregistrez le dossier des données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-113">If the same user uses your application repeatedly, and the web content of the application relies on the user’s data, save the user data folder.</span></span> <span data-ttu-id="6e3a2-114">Si plusieurs utilisateurs utilisent votre application de manière répétée, créez un nouveau dossier de données utilisateur pour chaque nouvel utilisateur, puis enregistrez le dossier des données utilisateur de chaque utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-114">If multiple users use your application repeatedly, create a new user data folder for each new user, and save the user data folder of each user.</span></span>
*   <span data-ttu-id="6e3a2-115">Si votre application n’a pas de répétition d’utilisateurs, créez un nouveau dossier de données utilisateur pour chaque utilisateur, puis supprimez le dossier des données utilisateur précédent.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-115">If your application does not have repeat users, create a new user data folder for each user, and delete the previous user data folder.</span></span>

## <span data-ttu-id="6e3a2-116">Créer des dossiers de données utilisateur</span><span class="sxs-lookup"><span data-stu-id="6e3a2-116">Create user data folders</span></span>

<span data-ttu-id="6e3a2-117">Pour spécifier l’emplacement du dossier de données de l’utilisateur, incluez le `userDataFolder` paramètre lors de l’appel de [ICoreWebView2Environment](../reference/win32/0-9-538/icorewebview2environment) (Win32) ou [CoreWebView2Environment](../reference/dotnet/0-9-538/microsoft-web-webview2-core-corewebview2environment) (.net).</span><span class="sxs-lookup"><span data-stu-id="6e3a2-117">To specify the location of the user data folder, include the `userDataFolder` parameter when calling [ICoreWebView2Environment](../reference/win32/0-9-538/icorewebview2environment) (Win32) or [CoreWebView2Environment](../reference/dotnet/0-9-538/microsoft-web-webview2-core-corewebview2environment) (.NET).</span></span> <span data-ttu-id="6e3a2-118">Après la création, les données de navigateur de votre contrôle WebView2 sont stockées dans un sous-dossier de `userDataFolder` .</span><span class="sxs-lookup"><span data-stu-id="6e3a2-118">After creation, browser data from your WebView2 control is stored in a subfolder of `userDataFolder`.</span></span> <span data-ttu-id="6e3a2-119">Lorsque `userDataFolder` n’est pas spécifié, WebView2 crée des dossiers de données utilisateur aux emplacements par défaut comme suit:</span><span class="sxs-lookup"><span data-stu-id="6e3a2-119">When `userDataFolder` is not specified, WebView2 creates user data folders at default locations as follows:</span></span>

* <span data-ttu-id="6e3a2-120">Pour les applications du Windows Store empaquetées, le dossier utilisateur par défaut est le sous `ApplicationData\LocalFolder` -dossier du dossier du package.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-120">For packaged Windows Store apps, the default user folder is the `ApplicationData\LocalFolder` subfolder in the package’s  folder.</span></span>
* <span data-ttu-id="6e3a2-121">Pour les applications de bureau existantes, le dossier de données utilisateur par défaut est le chemin d’accès exe de votre application + `.WebView2` .</span><span class="sxs-lookup"><span data-stu-id="6e3a2-121">For existing desktop apps, the default user data folder is the exe path of your application + `.WebView2`.</span></span> <span data-ttu-id="6e3a2-122">Au lieu d’utiliser la valeur par défaut, il est recommandé de spécifier un dossier de données utilisateur et de le créer dans le même dossier que celui où sont stockées toutes les autres données d’application.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-122">Instead of using the default, we recommend that you specify a user data folder, and that you create it in the same folder where all other app data is stored.</span></span>

## <span data-ttu-id="6e3a2-123">Supprimer des dossiers de données utilisateur</span><span class="sxs-lookup"><span data-stu-id="6e3a2-123">Delete user data folders</span></span>

<span data-ttu-id="6e3a2-124">Il est possible que votre application ait besoin de supprimer les dossiers de données des utilisateurs:</span><span class="sxs-lookup"><span data-stu-id="6e3a2-124">Your application may need to delete user data folders:</span></span>

* <span data-ttu-id="6e3a2-125">Lors de la désinstallation de votre application.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-125">When uninstalling your app.</span></span> <span data-ttu-id="6e3a2-126">Si vous désinstallez les applications du Windows Store empaquetées, Windows supprime automatiquement les dossiers de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-126">If you are uninstalling packaged Windows Store apps, Windows deletes user data folders automatically.</span></span> 
* <span data-ttu-id="6e3a2-127">Pour nettoyer l’historique de vos données de navigation.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-127">To clean up all browsing data history.</span></span>
* <span data-ttu-id="6e3a2-128">Pour récupérer des données endommagées.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-128">To recover from data corruption.</span></span>
* <span data-ttu-id="6e3a2-129">Pour supprimer les données de la session précédente.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-129">To remove previous session data.</span></span> 


> [!NOTE]
> <span data-ttu-id="6e3a2-130">Les fichiers dans les dossiers de données utilisateur sont peut-être toujours en cours d’utilisation après la fermeture de l’application WebView2.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-130">Files in user data folders may still be in use after the WebView2 application is closed.</span></span> <span data-ttu-id="6e3a2-131">Dans ce cas, attendez la fin du processus de navigateur et de tous les processus enfants avant de supprimer le dossier.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-131">In this situation, wait for the browser process and all child processes to exit before deleting the folder.</span></span> <span data-ttu-id="6e3a2-132">Vous pouvez récupérer l’ID de processus du processus du navigateur à l’aide `BrowserProcessId` de la propriété de WebView2.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-132">You may retrieve the process id of the browser process using the `BrowserProcessId` property of the WebView2.</span></span>

## <span data-ttu-id="6e3a2-133">Partager des dossiers de données utilisateur</span><span class="sxs-lookup"><span data-stu-id="6e3a2-133">Share user data folders</span></span>

<span data-ttu-id="6e3a2-134">Les contrôles WebView2 risquent de partager les mêmes dossiers de données utilisateur pour:</span><span class="sxs-lookup"><span data-stu-id="6e3a2-134">WebView2 controls may share the same user data folders to:</span></span>

* <span data-ttu-id="6e3a2-135">[Optimisez les ressources système](https://docs.microsoft.com/en-us/microsoft-edge/webview2/reference/win32/0-9-538/icorewebview2#process-model) en les exécutant dans un seul processus de navigateur.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-135">[Optimize system resources](https://docs.microsoft.com/en-us/microsoft-edge/webview2/reference/win32/0-9-538/icorewebview2#process-model) by running in one browser process.</span></span>
* <span data-ttu-id="6e3a2-136">Partager l’historique du navigateur et les ressources mises en cache.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-136">Share browser history and cached resources.</span></span> 

<span data-ttu-id="6e3a2-137">Prenez en considération les points suivants lors du partage de dossiers de données utilisateur:</span><span class="sxs-lookup"><span data-stu-id="6e3a2-137">Consider the following when sharing user data folders:</span></span> 

1. <span data-ttu-id="6e3a2-138">Lorsque vous recréez des contrôles WebView2 pour mettre à jour des versions de navigateur à l’aide d’événements [add_NewBrowserVersionAvailable](../reference/win32/0-9-538/icorewebview2environment#add_newbrowserversionavailable) (Win32) ou [NewBrowserVersionAvailable](../reference/dotnet/0-9-538/microsoft-web-webview2-core-corewebview2environment#newbrowserversionavailable) (.net), assurez-vous que les processus de navigateur ferment et ferment WebView2 des contrôles qui partagent le même dossier de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-138">When re-creating WebView2 controls to update browser versions using [add_NewBrowserVersionAvailable](../reference/win32/0-9-538/icorewebview2environment#add_newbrowserversionavailable) (Win32) or [NewBrowserVersionAvailable](../reference/dotnet/0-9-538/microsoft-web-webview2-core-corewebview2environment#newbrowserversionavailable) (.NET) events, ensure browser processes exit and close WebView2 controls that share the same user data folder.</span></span> <span data-ttu-id="6e3a2-139">Pour récupérer l’ID de processus du processus du navigateur, utilisez la `BrowserProcessId` propriété du contrôle WebView2.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-139">To retrieve the process id of the browser process, use the `BrowserProcessId` property of the WebView2 control.</span></span>

2. <span data-ttu-id="6e3a2-140">Les contrôles WebView2 qui partagent le même dossier de données utilisateur doivent utiliser les mêmes options pour [ICoreWebView2Environment](../reference/win32/0-9-538/icorewebview2environment) (Win32) ou [CoreWebView2Environment](../reference/dotnet/0-9-538/microsoft-web-webview2-core-corewebview2environment) (.net).</span><span class="sxs-lookup"><span data-stu-id="6e3a2-140">WebView2 controls that share the same user data folder must use the same options for [ICoreWebView2Environment](../reference/win32/0-9-538/icorewebview2environment) (Win32) or [CoreWebView2Environment](../reference/dotnet/0-9-538/microsoft-web-webview2-core-corewebview2environment) (.NET).</span></span> <span data-ttu-id="6e3a2-141">Si ce n’est pas le cas, la création de WebView2 échoue avec `HRESULT_FROM_WIN32(ERROR_INVALID_STATE)` .</span><span class="sxs-lookup"><span data-stu-id="6e3a2-141">If not, the WebView2 creation will fail with `HRESULT_FROM_WIN32(ERROR_INVALID_STATE)`.</span></span> 

<span data-ttu-id="6e3a2-142">Pour isoler différentes parties de votre application ou lorsque vous n’avez pas besoin de partager des données entre des contrôles WebView2, vous pouvez choisir d’utiliser différents dossiers de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-142">To isolate different parts of your application or when sharing data between WebView2 controls is not needed, you may choose to use different user data folders.</span></span> <span data-ttu-id="6e3a2-143">Par exemple, une application est composée de deux contrôles WebView2, l’un pour afficher une publicité et l’autre pour l’affichage du contenu de l’application.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-143">For example, an application may consist of two WebView2 controls, one for displaying an advertisement and the other for displaying application content.</span></span> <span data-ttu-id="6e3a2-144">Dans ce scénario, les développeurs peuvent choisir d’utiliser différents dossiers de données utilisateur pour chaque contrôle WebView2.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-144">In this scenario, developers may opt to use different user data folders for each WebView2 control.</span></span> 

> [!NOTE]
> <span data-ttu-id="6e3a2-145">Chaque processus de navigateur WebView2 utilise une mémoire et un espace disque supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-145">Each WebView2 browser process consumes additional memory and disk space.</span></span> <span data-ttu-id="6e3a2-146">Par conséquent, nous vous conseillons de ne pas exécuter WebView2s avec un trop grand nombre de dossiers de données utilisateur en même temps.</span><span class="sxs-lookup"><span data-stu-id="6e3a2-146">Therefore, we recommend not running WebView2s with too many different user data folders at the same time.</span></span> 
