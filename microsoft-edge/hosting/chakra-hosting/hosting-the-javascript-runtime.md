---
description: Utilisez le moteur JavaScript Chakra standard pour ajouter des fonctionnalités de script à votre application Windows.
title: Hébergement du runtime JavaScript | Documents Microsoft
ms.custom: ''
ms.date: 01/15/2020
ms.prod: microsoft-edge
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 30ec744e-57cc-4ef5-8fe1-d2c27b946548
caps.latest.revision: 14
author: MSEdgeTeam
ms.author: msedgedevrel
manager: ''
ms.openlocfilehash: 9077284d96ff0d9ae22e152329efe9304081ae39
ms.sourcegitcommit: 6860234c25a8be863b7f29a54838e78e120dbb62
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/09/2020
ms.locfileid: "10565282"
---
# <span data-ttu-id="b17a4-103">Hébergement du runtime JavaScript</span><span class="sxs-lookup"><span data-stu-id="b17a4-103">Hosting the JavaScript Runtime</span></span>
<span data-ttu-id="b17a4-104">Les API d’exécution JavaScript (JsRT) permettent aux applications de bureau, Windows Store et côté serveur qui s’exécutent sur le système d’exploitation Windows d’ajouter des fonctionnalités de script à l’application en utilisant le moteur JavaScript Chakra basé sur des normes, qui est également utilisé par Microsoft Edge et Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="b17a4-104">The JavaScript Runtime (JsRT) APIs provide a way for desktop, Windows Store, and server-side applications running on the Windows operating system to add scripting capabilities to the application by using the standards-based Chakra JavaScript engine that is also utilized by Microsoft Edge and Internet Explorer.</span></span> <span data-ttu-id="b17a4-105">Ces API sont disponibles sur Windows 10 et toutes les versions du système d’exploitation Windows sur lequel Internet Explorer version 11,0 est installé sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="b17a4-105">These APIs are available on Windows 10 and any version of the Windows operating system that has Internet Explorer version 11.0 installed on the machine.</span></span> <span data-ttu-id="b17a4-106">Pour plus d’informations, voir [Reference (Runtime JavaScript)](../chakra-hosting/reference-javascript-runtime.md).</span><span class="sxs-lookup"><span data-stu-id="b17a4-106">For more info, see [Reference (JavaScript Runtime)](../chakra-hosting/reference-javascript-runtime.md).</span></span> <span data-ttu-id="b17a4-107">Pour plus d’informations sur l’utilisation des JsRT dans les applications du Windows Store, voir [JsRT et la plateforme Windows universelle](#Windows).</span><span class="sxs-lookup"><span data-stu-id="b17a4-107">For info on using the JsRT in Windows Store apps, see [JsRT and the Universal Windows Platform](#Windows).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b17a4-108">Cette documentation suppose une connaissance générale du fonctionnement du langage JavaScript.</span><span class="sxs-lookup"><span data-stu-id="b17a4-108">This documentation assumes a general working familiarity with the JavaScript language.</span></span>  
  
## <span data-ttu-id="b17a4-109">Concepts</span><span class="sxs-lookup"><span data-stu-id="b17a4-109">Concepts</span></span>  
 <span data-ttu-id="b17a4-110">Le fonctionnement de l’hébergement du moteur JavaScript à l’aide des API JsRT dépend de deux concepts clés: runtimes et contextes d’exécution.</span><span class="sxs-lookup"><span data-stu-id="b17a4-110">Understanding how to host the JavaScript engine using the JsRT APIs depends on two key concepts: runtimes and execution contexts.</span></span>  
  
 <span data-ttu-id="b17a4-111">Un *Runtime* représente un environnement d’exécution JavaScript complet.</span><span class="sxs-lookup"><span data-stu-id="b17a4-111">A *runtime* represents a complete JavaScript execution environment.</span></span> <span data-ttu-id="b17a4-112">Chaque exécution créée possède son propre tas de nettoyage de la mémoire isolé et, par défaut, son propre thread de compilateur JIT et de nettoyage de la mémoire (CG).</span><span class="sxs-lookup"><span data-stu-id="b17a4-112">Each runtime that is created has its own isolated garbage collected heap and, by default, its own just-in-time (JIT) compiler thread and garbage collector (GC) thread.</span></span> <span data-ttu-id="b17a4-113">Un *contexte d’exécution* représente un environnement JavaScript sur lequel son propre objet global JavaScript est distinct de tous les autres contextes d’exécution.</span><span class="sxs-lookup"><span data-stu-id="b17a4-113">An *execution context* represents a JavaScript environment that has its own JavaScript global object distinct from all other execution contexts.</span></span> <span data-ttu-id="b17a4-114">Un Runtime doit contenir plusieurs contextes d’exécution, et dans ce cas, tous les contextes d’exécution partagent le compilateur JIT et le thread CG associés au Runtime.</span><span class="sxs-lookup"><span data-stu-id="b17a4-114">One runtime may contain multiple execution contexts, and in such cases, all the execution contexts share the JIT compiler and GC thread associated with the runtime.</span></span>  
  
 <span data-ttu-id="b17a4-115">Les runtimes représentent un thread d’exécution unique.</span><span class="sxs-lookup"><span data-stu-id="b17a4-115">Runtimes represent a single thread of execution.</span></span> <span data-ttu-id="b17a4-116">Un seul Runtime peut être actif sur un thread particulier à la fois, et un Runtime ne peut être actif que sur un thread à la fois.</span><span class="sxs-lookup"><span data-stu-id="b17a4-116">Only one runtime can be active on a particular thread at a time, and a runtime can only be active on one thread at a time.</span></span> <span data-ttu-id="b17a4-117">Les runtimes sont locatifs, de telle sorte qu’un Runtime qui n’est pas actif sur un thread (par exemple, n’exécute aucun code JavaScript ou ne répond à aucun appel de l’hôte) peut être utilisé sur tout thread sur lequel il n’existe pas déjà un Runtime actif.</span><span class="sxs-lookup"><span data-stu-id="b17a4-117">Runtimes are rental threaded, so a runtime that is not currently active on a thread (i.e. isn't running any JavaScript code or responding to any calls from the host) can be used on any thread that doesn't already have an active runtime on it.</span></span>  
  
 <span data-ttu-id="b17a4-118">Les contextes d’exécution sont liés à un Runtime particulier et exécutent du code au sein de ce Runtime.</span><span class="sxs-lookup"><span data-stu-id="b17a4-118">Execution contexts are tied to a particular runtime and execute code within that runtime.</span></span> <span data-ttu-id="b17a4-119">Contrairement aux runtimes, les contextes d’exécution multiples peuvent être actifs sur un thread en même temps.</span><span class="sxs-lookup"><span data-stu-id="b17a4-119">Unlike runtimes, multiple execution contexts can be active on a thread at the same time.</span></span> <span data-ttu-id="b17a4-120">Ainsi, un hôte peut passer un appel dans un contexte d’exécution, ce contexte d’exécution peut rappeler vers l’hôte, et l’hôte peut passer un appel dans un contexte d’exécution différent.</span><span class="sxs-lookup"><span data-stu-id="b17a4-120">So a host can make a call into an execution context, that execution context can call back to the host, and the host can make a call into a different execution context.</span></span>  
  
 ![Contextes d’exécution multiples](../chakra-hosting/media/js-chakra-hosting.png "JS_Chakra_Hosting")  
  
 <span data-ttu-id="b17a4-122">Dans la pratique, sauf si un hôte a besoin d’exécuter du code dans des environnements séparés, il est possible d’utiliser un contexte d’exécution unique.</span><span class="sxs-lookup"><span data-stu-id="b17a4-122">In practice, unless a host needs to run code in separated environments, a single execution context can be used.</span></span> <span data-ttu-id="b17a4-123">De même, sauf si un hôte doit exécuter plusieurs parties du code en même temps, un seul Runtime suffit.</span><span class="sxs-lookup"><span data-stu-id="b17a4-123">Similarly, unless a host needs to run multiple pieces of code concurrently, a single runtime is sufficient.</span></span>  
  
## <span data-ttu-id="b17a4-124">Gestion de la mémoire</span><span class="sxs-lookup"><span data-stu-id="b17a4-124">Memory management</span></span>  
 <span data-ttu-id="b17a4-125">JavaScript est un langage de nettoyage de la mémoire et il existe donc plusieurs considérations à garder à l’esprit lorsque vous travaillez avec les API JsRT à partir d’une autre langue.</span><span class="sxs-lookup"><span data-stu-id="b17a4-125">JavaScript is a garbage collected language, and thus there are several considerations that must be kept in mind when working with the JsRT APIs from another language.</span></span>  
  
 <span data-ttu-id="b17a4-126">Dans la plupart des cas, le garbage collector JavaScript peut uniquement voir les références à des valeurs à deux emplacements: le tas de son Runtime et la pile.</span><span class="sxs-lookup"><span data-stu-id="b17a4-126">The main consideration is that the JavaScript garbage collector can only see references to values in two places: its runtime's heap, and the stack.</span></span> <span data-ttu-id="b17a4-127">Par conséquent, une référence à une valeur JavaScript qui est stockée à l’intérieur d’une autre valeur JavaScript ou dans une variable locale sur la pile sera toujours visible par le récupérateur de mémoire.</span><span class="sxs-lookup"><span data-stu-id="b17a4-127">Thus, a reference to a JavaScript value that is stored inside of another JavaScript value or in a local variable on the stack will always be seen by the garbage collector.</span></span> <span data-ttu-id="b17a4-128">Toutefois, les références stockées dans d’autres emplacements (par exemple, les tas gérés par l’hôte ou le système) ne seront pas visibles par le récupérateur de mémoire et pourront entraîner une collection prématurée de valeurs qui sont toujours en cours d’utilisation par l’hôte.</span><span class="sxs-lookup"><span data-stu-id="b17a4-128">But references stored in other locations, such as heaps managed by the host or the system, will not be seen by the garbage collector and may result in premature collection of values that are still in use by the host.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="b17a4-129">Certains compilateurs de langage (comme le compilateur Visual Studio C++) optimisent les variables locales lorsque c’est possible.</span><span class="sxs-lookup"><span data-stu-id="b17a4-129">Some language compilers (such as the Visual Studio C++ compiler) will optimize away local variables where possible.</span></span> <span data-ttu-id="b17a4-130">Il est nécessaire de veiller à ce que les variables locales qui font référence à des valeurs JavaScript se trouvent sur la pile s’il est prévu de conserver ces valeurs actif.</span><span class="sxs-lookup"><span data-stu-id="b17a4-130">Care must be taken to ensure that local variables that reference JavaScript values are on the stack if they are expected to keep those values alive.</span></span>  
  
 <span data-ttu-id="b17a4-131">Si une référence à une valeur JavaScript sera stockée dans un emplacement invisible pour le nettoyage de la mémoire, l’hôte doit ajouter et supprimer manuellement des références à l’aide des API JsRT.</span><span class="sxs-lookup"><span data-stu-id="b17a4-131">If a reference to a JavaScript value will be stored in a location not visible to the garbage collector, the host must manually add and remove references using the JsRT APIs.</span></span>  
  
## <span data-ttu-id="b17a4-132">Gestion des exceptions</span><span class="sxs-lookup"><span data-stu-id="b17a4-132">Exception handling</span></span>  
 <span data-ttu-id="b17a4-133">Quand une exception JavaScript se produit pendant l’exécution du script, le runtime contenant est placé dans un état d’exception.</span><span class="sxs-lookup"><span data-stu-id="b17a4-133">When a JavaScript exception occurs during script execution, the containing runtime is put into an exception state.</span></span> <span data-ttu-id="b17a4-134">Dans un état d’exception, il n’est pas possible d’exécuter le code et tous les appels d’API échoueront avec le code d’erreur `JsErrorInExceptionState` jusqu’à ce que l’hôte récupère et efface l’exception à l’aide de l' `JsGetAndClearException` API.</span><span class="sxs-lookup"><span data-stu-id="b17a4-134">While in an exception state, no code can run and all API calls will fail with the error code `JsErrorInExceptionState` until the host retrieves and clears the exception using the `JsGetAndClearException` API.</span></span> <span data-ttu-id="b17a4-135">Si l’hôte retourne à partir d’un rappel JavaScript sans vider le runtime d’un état d’exception, l’exception JavaScript est rélevée dès que le contrôle est transmis au moteur JavaScript.</span><span class="sxs-lookup"><span data-stu-id="b17a4-135">If the host returns from a JavaScript callback without clearing the runtime from an exception state, then the JavaScript exception will be re-thrown as soon as control passes back to the JavaScript engine.</span></span> <span data-ttu-id="b17a4-136">Cela permet également aux rappels d’hôte de «lever» une exception JavaScript en définissant le runtime dans un état d’exception, puis en renvoyant un rappel d’hôte.</span><span class="sxs-lookup"><span data-stu-id="b17a4-136">This also enables host callbacks to "throw" a JavaScript exception by setting the runtime into an exception state and then returning from a host callback.</span></span>  
  
 <span data-ttu-id="b17a4-137">Un hôte n’est pas autorisé à laisser ses propres exceptions internes à être propagées sur un rappel d’hôte: toutes les méthodes de rappel doivent intercepter toutes les exceptions d’hôte avant de redéfinir le contrôle pour le Runtime.</span><span class="sxs-lookup"><span data-stu-id="b17a4-137">A host is not allowed to let its own internal exceptions to propagate across a host callback—any callback methods must catch all host exceptions before returning control to the runtime.</span></span>  
  
## <span data-ttu-id="b17a4-138">Utilisation des ressources au moment de l’exécution</span><span class="sxs-lookup"><span data-stu-id="b17a4-138">Runtime resource usage</span></span>  
 <span data-ttu-id="b17a4-139">Les API JsRT présentent un certain nombre de moyens de surveiller et de modifier la façon dont les runtimes utilisent les ressources.</span><span class="sxs-lookup"><span data-stu-id="b17a4-139">The JsRT APIs expose a number of way to monitor and modify the way runtimes use resources.</span></span> <span data-ttu-id="b17a4-140">Ils sont généralement réparties dans les catégories suivantes:</span><span class="sxs-lookup"><span data-stu-id="b17a4-140">They generally break down into the following categories:</span></span>  
  
-   <span data-ttu-id="b17a4-141">**Utilisation du thread**.</span><span class="sxs-lookup"><span data-stu-id="b17a4-141">**Thread Usage**.</span></span> <span data-ttu-id="b17a4-142">Par défaut, chaque Runtime crée un thread de compilateur JIT dédié et un thread de CG dédié qui service ce Runtime.</span><span class="sxs-lookup"><span data-stu-id="b17a4-142">By default, each runtime will create a dedicated JIT compiler thread and a dedicated GC thread that service that runtime.</span></span> <span data-ttu-id="b17a4-143">Si un Runtime est créé avec l' `JsRuntimeAttributeDisableBackgroundWork` indicateur, le processus JIT et GC sera exécuté sur le thread d’exécution proprement dit au lieu de threads d’arrière-plan distinctes pour chacun d’eux.</span><span class="sxs-lookup"><span data-stu-id="b17a4-143">If a runtime is created with the `JsRuntimeAttributeDisableBackgroundWork` flag, then the JIT and GC work will be performed on the runtime thread itself instead of separate background threads for each one of them.</span></span> <span data-ttu-id="b17a4-144">Un hôte peut également fournir un rappel de service de thread à l' `JsCreateRuntime` appel, ce qui permet à l’hôte de planifier le fonctionnement du JIT et du CG en fonction du fonctionnement.</span><span class="sxs-lookup"><span data-stu-id="b17a4-144">A host can also supply a thread service callback to the `JsCreateRuntime` call, which will allow the host to schedule JIT and GC work in any way it sees fit.</span></span>  
  
-   <span data-ttu-id="b17a4-145">**Utilisation**de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="b17a4-145">**Memory Usage**.</span></span> <span data-ttu-id="b17a4-146">Il existe plusieurs façons de surveiller et de modifier l’utilisation de la mémoire d’un Runtime.</span><span class="sxs-lookup"><span data-stu-id="b17a4-146">There are several ways to monitor and modify the memory usage of a runtime.</span></span> <span data-ttu-id="b17a4-147">Si le runtime s’exécute pendant un certain temps, l’hôte peut spécifier l' `JsRuntimeAttributeEnableIdleProcessing` indicateur lors de la création du runtime, puis appeler `JsIdle` lorsque l’hôte est dans un état inactif.</span><span class="sxs-lookup"><span data-stu-id="b17a4-147">If the runtime will be running for a long time, the host can specify the `JsRuntimeAttributeEnableIdleProcessing` flag when creating the runtime and then call `JsIdle` when the host is in an idle state.</span></span> <span data-ttu-id="b17a4-148">Cela permet au moteur de différer le nettoyage de la mémoire et de gérer le fonctionnement jusqu’au temps d’inactivité.</span><span class="sxs-lookup"><span data-stu-id="b17a4-148">This allows the engine to defer some memory cleanup and bookkeeping work until idle time.</span></span>  
  
     <span data-ttu-id="b17a4-149">L’hôte peut surveiller les nettoyages de la mémoire en appelant `JsSetRuntimeBeforeCollectCallback` .</span><span class="sxs-lookup"><span data-stu-id="b17a4-149">The host can monitor garbage collections by calling `JsSetRuntimeBeforeCollectCallback`.</span></span> <span data-ttu-id="b17a4-150">Il peut également surveiller les attributions effectuées par le tas en appelant `JsSetRuntimeMemoryAllocationCallback` .</span><span class="sxs-lookup"><span data-stu-id="b17a4-150">It can also monitor allocations made by the heap by calling `JsSetRuntimeMemoryAllocationCallback`.</span></span> <span data-ttu-id="b17a4-151">Notez que cette API n’effectue pas de rappel à chaque attribution JavaScript, uniquement lorsque le tas du runtime a besoin d’espace supplémentaire à partir duquel allouer.</span><span class="sxs-lookup"><span data-stu-id="b17a4-151">Note that this API does not call back on every JavaScript allocation, just when the runtime's heap needs more space from which to allocate.</span></span> <span data-ttu-id="b17a4-152">Le rappel d’allocation de mémoire est autorisé à refuser la demande, ce qui déclenche un nettoyage de la mémoire et, si aucune mémoire n’est disponible, une erreur de mémoire insuffisante dans le Runtime.</span><span class="sxs-lookup"><span data-stu-id="b17a4-152">The memory allocation callback is allowed to deny the request, which will trigger a garbage collection and, if no memory is available, an out of memory error in the runtime.</span></span>  
  
     <span data-ttu-id="b17a4-153">L’hôte peut également appeler `JsSetRuntimeMemoryLimit` pour définir une limite de la quantité de mémoire utilisée par un Runtime.</span><span class="sxs-lookup"><span data-stu-id="b17a4-153">The host can also call `JsSetRuntimeMemoryLimit` to set a limit for how much memory a runtime can use.</span></span> <span data-ttu-id="b17a4-154">Lorsque le runtime atteint une limite, il déclenche un nettoyage de la mémoire et, si aucune mémoire n’est disponible, une erreur de mémoire insuffisante est levée par le Runtime.</span><span class="sxs-lookup"><span data-stu-id="b17a4-154">When a runtime hits a limit, it will trigger a garbage collection and, if no memory is available, an out of memory error will be thrown by the runtime.</span></span>  
  
-   <span data-ttu-id="b17a4-155">**Interruption et évaluation des scripts**.</span><span class="sxs-lookup"><span data-stu-id="b17a4-155">**Script Interruption and Evaluation**.</span></span> <span data-ttu-id="b17a4-156">L’hôte peut appeler `JsDisableRuntimeExecution` pour terminer l’exécution au sein d’un Runtime.</span><span class="sxs-lookup"><span data-stu-id="b17a4-156">The host can call `JsDisableRuntimeExecution` to terminate execution within a runtime.</span></span> <span data-ttu-id="b17a4-157">Cet appel peut être effectué à tout moment et à partir de n’importe quel thread.</span><span class="sxs-lookup"><span data-stu-id="b17a4-157">This call can be made at any time and from any thread.</span></span> <span data-ttu-id="b17a4-158">Dans la mesure où l’arrêt du script dépend de l’insertion de points de protection dans le code, il est possible que le script ne se termine pas au moment précis, mais qu’il le fera très prochainement.</span><span class="sxs-lookup"><span data-stu-id="b17a4-158">Because script termination depends on reaching guard points inserted into the code, a script may not terminate at the exact moment, but will do so very shortly afterwards.</span></span> <span data-ttu-id="b17a4-159">Par défaut, les points de protection de fin sont placés de manière conservatrice dans le code généré et ne peuvent pas être couverts par une boucle infinie.</span><span class="sxs-lookup"><span data-stu-id="b17a4-159">By default, termination guard points are placed in the generated code conservatively and may not cover every situation, such as an infinite loop.</span></span> <span data-ttu-id="b17a4-160">La création du Runtime avec l' `JsRuntimeAttributeAllowScriptInterrupt` indicateur amène le runtime à insérer des vérifications supplémentaires pour les boucles infinies, souvent au coût d’une faible surcharge des performances.</span><span class="sxs-lookup"><span data-stu-id="b17a4-160">Creating the runtime with the `JsRuntimeAttributeAllowScriptInterrupt` flag causes the runtime to insert additional checks for infinite loops, often at the cost of a small performance overhead.</span></span>  
  
     <span data-ttu-id="b17a4-161">Si un hôte souhaite refuser la génération de code natif par le compilateur JIT, il peut spécifier l' `JsRuntimeAttributeDisableNativeCodeGeneration` indicateur.</span><span class="sxs-lookup"><span data-stu-id="b17a4-161">If a host wishes to disallow generation of native code by the JIT compiler, it can specify the `JsRuntimeAttributeDisableNativeCodeGeneration` flag.</span></span> <span data-ttu-id="b17a4-162">Un hôte peut également désactiver les scripts de manière dynamique en exécutant des scripts eux-mêmes en spécifiant l' `JsRuntimeAttributeDisableEval` indicateur.</span><span class="sxs-lookup"><span data-stu-id="b17a4-162">A host can also disallow scripts from dynamically running scripts itself by specifying the `JsRuntimeAttributeDisableEval` flag.</span></span>  
  
## <span data-ttu-id="b17a4-163">Débogage et profilage</span><span class="sxs-lookup"><span data-stu-id="b17a4-163">Debugging and Profiling</span></span>  
 <span data-ttu-id="b17a4-164">Les API JsRT prennent en charge le débogage et le profil via la technologie d’écriture de script active.</span><span class="sxs-lookup"><span data-stu-id="b17a4-164">JsRT APIs supports debugging and profiling via the Active Scripting technology.</span></span>  
  
 <span data-ttu-id="b17a4-165">À partir de Windows 10, le moteur JavaScript Chakra prend en charge le moteur d’ancienne version d’Internet Explorer (MSHTML) et le nouveau moteur Microsoft Edge (EdgeHTML), et vous pouvez le cibler dans JsRT (pour plus d’informations sur le [ciblage des moteurs Microsoft Edge et hérités](../chakra-hosting/targeting-edge-vs-legacy-engines-in-jsrt-apis.md) ).</span><span class="sxs-lookup"><span data-stu-id="b17a4-165">Starting in Windows 10, the Chakra JavaScript Engine supports the legacy Internet Explorer (MSHTML) engine and new Microsoft Edge (EdgeHTML) engine, and you can target either in JsRT (see [Targeting Microsoft Edge vs. Legacy Engines](../chakra-hosting/targeting-edge-vs-legacy-engines-in-jsrt-apis.md) for details).</span></span> <span data-ttu-id="b17a4-166">Le débogage d’un script dans Visual Studio fonctionne différemment entre le moteur hérité et le moteur Microsoft Edge.</span><span class="sxs-lookup"><span data-stu-id="b17a4-166">Debugging a script in Visual Studio works differently between the legacy engine and Microsoft Edge engine.</span></span> <span data-ttu-id="b17a4-167">Avec le moteur hérité, l’hôte doit fournir un pointeur d' [interface IDebugApplication](/scripting/winscript/reference/idebugapplication-interface) , qui peut être obtenu à partir d’une instance d' [interface IProcessDebugManager](/scripting/winscript/reference/iprocessdebugmanager-interface) .</span><span class="sxs-lookup"><span data-stu-id="b17a4-167">With the legacy engine, the host needs to provide an [IDebugApplication Interface](/scripting/winscript/reference/idebugapplication-interface) pointer, which can be obtained from an [IProcessDebugManager Interface](/scripting/winscript/reference/iprocessdebugmanager-interface) instance.</span></span> <span data-ttu-id="b17a4-168">Le moteur Microsoft Edge `IDebugApplication` est déconseillé, et le moteur Chakra autorise les fonctionnalités de débogage native et de script par le biais du débogueur Visual Studio, sans nécessiter `IDebugApplication` l’implémentation de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b17a4-168">With the Microsoft Edge engine, `IDebugApplication` is deprecated, and the Chakra engine enables native and script debugging capabilities through the Visual Studio debugger without requiring an implementation of `IDebugApplication` from the user.</span></span>  
  
 <span data-ttu-id="b17a4-169">Pour faciliter le débogage des scripts dans un contexte d’exécution, le moteur Chakra doit basculer vers l’utilisation de méthodes d’exécution de code moins efficaces.</span><span class="sxs-lookup"><span data-stu-id="b17a4-169">To make scripts in an execution context debuggable, the Chakra engine has to switch to using less efficient code execution methods.</span></span> <span data-ttu-id="b17a4-170">Par exemple, le code déboguable s’exécute généralement plus lentement que le code non déboguable.</span><span class="sxs-lookup"><span data-stu-id="b17a4-170">As such, debuggable code typically runs slower than non-debuggable code.</span></span> <span data-ttu-id="b17a4-171">Par conséquent, avec le moteur hérité, un hôte peut choisir de démarrer le débogage dans un contexte d’exécution à partir du début en fournissant le `IDebugApplication` pointeur vers l’avant `JsCreateContext` , ou il peut patienter jusqu’à ce que le débogage soit nécessaire, puis appeler `JsStartDebugging` .</span><span class="sxs-lookup"><span data-stu-id="b17a4-171">As a result, with the legacy engine, a host can choose to either start debugging in an execution context from the beginning by providing the `IDebugApplication` pointer up front through `JsCreateContext`, or it can wait until debugging is needed and then call `JsStartDebugging`.</span></span> <span data-ttu-id="b17a4-172">Le moteur Microsoft Edge `JsCreateContext` n’accepte plus un `IDebugApplication` paramètre et, par conséquent, le script est débogué uniquement après `JsStartDebugging` appelé.</span><span class="sxs-lookup"><span data-stu-id="b17a4-172">With the Microsoft Edge engine, `JsCreateContext` no longer takes an `IDebugApplication` parameter, and as a result the script is debuggable only after `JsStartDebugging` is called.</span></span> <span data-ttu-id="b17a4-173">Lors du débogage à l’aide de Visual Studio, l’option de débogueur «script» doit être activée.</span><span class="sxs-lookup"><span data-stu-id="b17a4-173">When debugging using Visual Studio, the "Script" debugger option must be enabled.</span></span>  
  
 <span data-ttu-id="b17a4-174">Le code JavaScript dans un contexte d’exécution peut être profilé de l’une des deux manières suivantes.</span><span class="sxs-lookup"><span data-stu-id="b17a4-174">The JavaScript code in an execution context can be profiled in one of two ways.</span></span> <span data-ttu-id="b17a4-175">La ligne de commande Visual Studio Profiler (VSPerf. exe) peut être utilisée dans Windows 8,1 et les versions ultérieures avec le commutateur/js pour générer un rapport ciblant le code JavaScript exécuté dans l’application.</span><span class="sxs-lookup"><span data-stu-id="b17a4-175">The command line Visual Studio Profiler (vsperf.exe) can be used in Windows 8.1 and later versions with the /js switch to produce a report that targets the JavaScript code run in the application.</span></span> <span data-ttu-id="b17a4-176">L’hôte peut appeler `JsStartProfiling` et fournir directement `JsStopProfiling` un rappel pour effectuer le profilage.</span><span class="sxs-lookup"><span data-stu-id="b17a4-176">Or the host can directly call `JsStartProfiling` and `JsStopProfiling` and provide a callback to do profiling itself.</span></span> <span data-ttu-id="b17a4-177">L’hôte peut également examiner l’état du tas récupéré par le garbage collector en appelant `JsEnumerateHeap` .</span><span class="sxs-lookup"><span data-stu-id="b17a4-177">The host can also examine the state of the garbage collected heap by calling `JsEnumerateHeap`.</span></span> <span data-ttu-id="b17a4-178">Le profilage dans JsRT fonctionne de la même manière que celle du moteur hérité et du moteur Microsoft Edge.</span><span class="sxs-lookup"><span data-stu-id="b17a4-178">Profiling in JsRT works in the same manner between the legacy and the Microsoft Edge engine.</span></span> <span data-ttu-id="b17a4-179">Toutefois, les API de profil JsRT ( `JsStartProfiling` , `JsStopProfiling` , `JsEnumerateHeap` et `JsIsEnumeratingHeap` ) ne sont pas disponibles pour les applications Windows universelles.</span><span class="sxs-lookup"><span data-stu-id="b17a4-179">However, JsRT profiling APIs (`JsStartProfiling`, `JsStopProfiling`, `JsEnumerateHeap`, and `JsIsEnumeratingHeap`) are not available for Universal Windows Apps.</span></span>  
  
<a name="Windows"></a>   
## <span data-ttu-id="b17a4-180">JsRT et plateforme Windows universelle</span><span class="sxs-lookup"><span data-stu-id="b17a4-180">JsRT and the Universal Windows Platform</span></span>  

<span data-ttu-id="b17a4-181">Vous pouvez utiliser les API JsRT pour ajouter des fonctionnalités d’écriture de script à une application Windows universelle.</span><span class="sxs-lookup"><span data-stu-id="b17a4-181">You can use JsRT APIs to add scripting capabilities to a Universal Windows app.</span></span> <span data-ttu-id="b17a4-182">Une application Windows universelle qui utilise les API JsRT doit cibler les API Microsoft Edge JSRT, qui à son tour cibler le moteur Chakra Edge.</span><span class="sxs-lookup"><span data-stu-id="b17a4-182">A Universal Windows app that uses the JsRT APIs will need to target the Microsoft Edge JSRT APIs, which in turn target the Edge Chakra engine.</span></span> <span data-ttu-id="b17a4-183">Pour plus d’informations, reportez-vous à la rubrique [ciblage des moteurs Microsoft Edge et hérités](../chakra-hosting/targeting-edge-vs-legacy-engines-in-jsrt-apis.md).</span><span class="sxs-lookup"><span data-stu-id="b17a4-183">For more information, see [Targeting Microsoft Edge vs. Legacy Engines](../chakra-hosting/targeting-edge-vs-legacy-engines-in-jsrt-apis.md).</span></span> <span data-ttu-id="b17a4-184">L’API JsRT complète est disponible pour les applications Windows universelles, à l’exception de la prise en charge de l’énumération et du profilage ( `JsStartProfiling` , `JsStopProfiling` `JsEnumerateHeap` et `JsIsEnumeratingHeap` non prise en charge).</span><span class="sxs-lookup"><span data-stu-id="b17a4-184">The complete JsRT API is available for Universal Windows apps, except for profiling and heap enumeration support (`JsStartProfiling`, `JsStopProfiling`, `JsEnumerateHeap`, and `JsIsEnumeratingHeap` are not supported).</span></span>  
  
<span data-ttu-id="b17a4-185">JsRT autorise également les scripts à accéder en natif aux API de la [plateforme Windows universelle (UWP)](https://msdn.microsoft.com/library/windows/apps/br211377.aspx) après avoir exposé l’espace de noms de l’API via l’API JsRT de Microsoft Edge `JsProjectWinRTNamespace` .</span><span class="sxs-lookup"><span data-stu-id="b17a4-185">JsRT also allows scripts to natively access any [Universal Windows Platform (UWP) APIs](https://msdn.microsoft.com/library/windows/apps/br211377.aspx) after exposing the API namespace through Microsoft Edge JsRT API `JsProjectWinRTNamespace`.</span></span> <span data-ttu-id="b17a4-186">Les applications Windows universelles ne nécessitent pas de configuration en plus des espaces de noms nécessaires pour projecter dans une application Windows classique (Win32), un mécanisme de pompage délégué initialisé par COM doit être activé `JsSetProjectionEnqueueCallback` pour activer des événements et des API asynchrones.</span><span class="sxs-lookup"><span data-stu-id="b17a4-186">While Universal Windows Applications require no setup in addition to projecting necessary namespaces, in a Classic (Win32) Windows Application, a COM-initialized delegated pumping mechanism needs to be enabled through `JsSetProjectionEnqueueCallback` to enable events and asynchronous APIs.</span></span> <span data-ttu-id="b17a4-187">L’exemple Win32 suivant fait appel à des API UWP asynchrones pour créer un client http et obtenir du contenu à partir d’un URI:</span><span class="sxs-lookup"><span data-stu-id="b17a4-187">The following Win32 sample utilizes asynchronous UWP APIs to create an http client to get content from a Uri:</span></span>  
  
```cpp  
typedef struct _jsCall {  
    JsProjectionCallback jsCallback;  
    JsProjectionCallbackContext jsContext;  
    HANDLE event;  
} jsCall;  
  
// Set up delegated pumping mechanism; not necessary in UWP applications.  
jsCall outstandingCall = {};  
CoInitializeEx(nullptr, COINIT_MULTITHREADED);  
JsSetProjectionEnqueueCallback([](JsProjectionCallback jsCallback,   
JsProjectionCallbackContext jsContext, void *callbackState) {  
    jsCall* call = (jsCall*)callbackState;  
    call->jsCallback = jsCallback;  
    call->jsContext = jsContext;  
    SetEvent(call->event);  
    },  
&outstandingCall);  
HANDLE event = CreateEventEx(NULL, NULL, CREATE_EVENT_MANUAL_RESET, EVENT_ALL_ACCESS);  
outstandingCall.event = event;  
  
// Project necessary namespaces.  
JsProjectWinRTNamespace(L"Windows.Foundation");  
JsProjectWinRTNamespace(L"Windows.Web");  
  
// Get content from an Uri.  
JsRunScript(L"var uri = new Windows.Foundation.Uri(\"http://somedatasource.com\"); " \  
    L"var httpClient = new Windows.Web.Http.HttpClient();" \  
    L"httpClient.getStringAsync(uri).done(function (content) { " \  
    L"    // do something with the string content " \    
    L"}, onError); " \  
    L"function onError(reason) { " \  
    L"    // error handling " \        
    L"}",   
    currentSourceContext, L"", &result);  
  
// Wait for async call to come in and then execute; not necessary in UWP applications.  
WaitForSingleObjectEx(outstandingCall.event, 10000, FALSE) == WAIT_OBJECT_0;  
outstandingCall.jsCallback(outstandingCall.jsContext);  
  
```  
  
## <span data-ttu-id="b17a4-188">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b17a4-188">See Also</span></span>  
 [<span data-ttu-id="b17a4-189">Exemple d’application JavaScript Runtime</span><span class="sxs-lookup"><span data-stu-id="b17a4-189">JavaScript Runtime Sample App</span></span>](https://go.microsoft.com/fwlink/p/?LinkID=306674&clcid=0x409)   
 [<span data-ttu-id="b17a4-190">Référence (Runtime JavaScript)</span><span class="sxs-lookup"><span data-stu-id="b17a4-190">Reference (JavaScript Runtime)</span></span>](../chakra-hosting/reference-javascript-runtime.md)   
 [<span data-ttu-id="b17a4-191">Hébergement Runtime JavaScript</span><span class="sxs-lookup"><span data-stu-id="b17a4-191">JavaScript Runtime Hosting</span></span>](../javascript-runtime-hosting.md)  
 